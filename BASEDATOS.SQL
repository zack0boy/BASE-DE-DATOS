CREATE TABLE JNG_USUARIO (
    ID_USUARIO NUMBER PRIMARY KEY,
    ID_ROL NUMBER,
    NOMBRE VARCHAR2(200),
    APELLIDO VARCHAR2(200),
    RUT VARCHAR2(50) UNIQUE,
    EMAIL VARCHAR2(200) UNIQUE,
    PASSWORD VARCHAR2(200),
    FECHA_NAC DATE,
    ESTADO VARCHAR2(20) DEFAULT 'ACTIVE',
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP
);

CREATE TABLE JNG_ROL (
    ID_ROL NUMBER PRIMARY KEY,
    NOMBRE_ROL VARCHAR2(100),
    DESCRIPCION VARCHAR2(400)
);

CREATE TABLE JNG_PERMISO (
    ID_PERMISO NUMBER PRIMARY KEY,
    NOMBRE VARCHAR2(200)
);

CREATE TABLE JNG_UNIVERSIDAD (
    ID_UNIVERSIDAD NUMBER PRIMARY KEY,
    NOMBRE VARCHAR2(300),
    DIRECCION VARCHAR2(400)
);

CREATE TABLE JNG_SEDE (
    ID_SEDE NUMBER PRIMARY KEY,
    ID_UNIVERSIDAD NUMBER,
    NOMBRE VARCHAR2(200),
    DIRECCION VARCHAR2(300)
);

CREATE TABLE JNG_CARRERA (
    ID_CARRERA NUMBER PRIMARY KEY,
    ID_SEDE NUMBER,
    NOMBRE VARCHAR2(300),
    DESCRIPCION VARCHAR2(1000),
    ID_DIRECTOR NUMBER
);

CREATE TABLE JNG_PLAN_ESTUDIOS (
    ID_PLAN NUMBER PRIMARY KEY,
    ID_CARRERA NUMBER,
    YEAR_INICIO NUMBER,
    YEAR_FIN NUMBER
);

CREATE TABLE JNG_ASIGNATURA (
    ID_ASIGNATURA NUMBER PRIMARY KEY,
    ID_CARRERA NUMBER,
    NOMBRE VARCHAR2(300),
    CODIGO VARCHAR2(100),
    CREDITOS NUMBER(3),
    DESCRIPCION VARCHAR2(500),
    CONSTRAINT CHK_ASIG_CREDITOS CHECK (CREDITOS > 0)
);

CREATE TABLE JNG_ASIGNATURA_CARRERA (
    ID_PLAN NUMBER,
    ID_ASIGNATURA NUMBER,
    SEMESTRE NUMBER
);

CREATE TABLE JNG_PREREQUISITO (
    ID_ASIGNATURA NUMBER,
    ID_ASIGNATURA_REQ NUMBER
);

CREATE TABLE JNG_SECCION (
    ID_SECCION NUMBER PRIMARY KEY,
    ID_ASIGNATURA NUMBER,
    ID_PERIODO NUMBER,
    NUMERO NUMBER,
    GRUPO VARCHAR2(50),
    CUPOS NUMBER(3) DEFAULT 0 CHECK (CUPOS >= 0)
);


CREATE TABLE JNG_PERIODO_ACADEMICO (
    ID_PERIODO NUMBER PRIMARY KEY,
    YEAR_NUM NUMBER,
    SEMESTRE NUMBER
);

CREATE TABLE JNG_AULA (
    ID_AULA NUMBER PRIMARY KEY,
    ID_SEDE NUMBER,
    NOMBRE VARCHAR2(200),
    CAPACIDAD NUMBER(3),
    CONSTRAINT CHK_AULA_CAPACIDAD CHECK (CAPACIDAD > 0)
);

CREATE TABLE JNG_HORARIO (
    ID_HORARIO NUMBER PRIMARY KEY,
    ID_SECCION NUMBER,
    ID_AULA NUMBER,
    DIA_SEMANA VARCHAR2(20),
    HORA_INICIO TIMESTAMP,
    HORA_FIN TIMESTAMP
);

CREATE TABLE JNG_ASIGNACION_DOCENTE (
    ID_ASIGNACION_DOCENTE NUMBER PRIMARY KEY,
    ID_USUARIO NUMBER,
    ID_SECCION NUMBER
);

CREATE TABLE JNG_ASIGNACION_SECRETARIA (
    ID_ASIGNACION_SECRETARIA NUMBER PRIMARY KEY,
    ID_USUARIO NUMBER,
    ID_SEDE NUMBER,
    AREA VARCHAR2(200)
);

CREATE TABLE JNG_AYUDANTIA (
    ID_AYUDANTIA NUMBER PRIMARY KEY,
    ID_USUARIO NUMBER,
    ID_CARRERA NUMBER,
    ID_SECCION NUMBER
);

CREATE TABLE JNG_ALUMNO (
    ID_ALUMNO NUMBER PRIMARY KEY,
    ID_USUARIO NUMBER,          
    ID_CARRERA NUMBER NOT NULL, 
    FECHA_INGRESO DATE
);

CREATE TABLE JNG_INSCRIPCION (
    ID_INSCRIPCION NUMBER PRIMARY KEY,
    ID_ALUMNO NUMBER,
    ID_SECCION NUMBER
);

CREATE TABLE JNG_TIPO_ACTIVIDAD (
    ID_TIPO_ACTIVIDAD NUMBER PRIMARY KEY,
    NOMBRE VARCHAR2(200)
);

CREATE TABLE JNG_ACTIVIDAD (
    ID_ACTIVIDAD NUMBER PRIMARY KEY,
    ID_SECCION NUMBER,
    ID_TIPO_ACTIVIDAD NUMBER,
    DESCRIPCION VARCHAR2(1000),
    FECHA DATE
);

CREATE TABLE JNG_TIPO_EVALUACION (
    ID_TIPO_EVALUACION NUMBER PRIMARY KEY,
    NOMBRE VARCHAR2(200)
);

CREATE TABLE JNG_EVALUACION (
    ID_EVALUACION NUMBER PRIMARY KEY,
    ID_SECCION NUMBER,
    ID_TIPO_EVALUACION NUMBER,
    TITULO VARCHAR2(400),
    PORCENTAJE NUMBER(5,2),
    CONSTRAINT CHK_EVAL_PORCENTAJE CHECK (PORCENTAJE >= 0 AND PORCENTAJE <= 100)
);

CREATE TABLE JNG_NOTA (
    ID_NOTA NUMBER PRIMARY KEY,
    ID_EVALUACION NUMBER,
    ID_ALUMNO NUMBER,
    NOTA NUMBER(3,1),
    CONSTRAINT CHK_NOTA_RANGO CHECK (NOTA >= 0 AND NOTA <= 7)
);
CREATE TABLE JNG_CONTENIDO (
    ID_CONTENIDO NUMBER PRIMARY KEY,
    ID_ASIGNATURA NUMBER,
    TITULO VARCHAR2(400),
    DESCRIPCION VARCHAR2(2000)
);

CREATE TABLE JNG_MATERIAL_CURSO (
    ID_MATERIAL NUMBER PRIMARY KEY,
    ID_SECCION NUMBER,
    ID_USUARIO NUMBER,
    TITULO VARCHAR2(400),
    URL VARCHAR2(2000),
    FECHA_SUBIDA DATE
);

CREATE TABLE JNG_MENSAJE_INTERNO (
    ID_MENSAJE NUMBER PRIMARY KEY,
    ID_USUARIO_ENVIA NUMBER,
    ID_USUARIO_RECIBE NUMBER,
    CONTENIDO VARCHAR2(4000),
    FECHA DATE
);

CREATE TABLE JNG_ANUNCIO (
    ID_ANUNCIO NUMBER PRIMARY KEY,
    ID_USUARIO NUMBER,
    ID_SECCION NUMBER,
    ID_CARRERA NUMBER,
    TITULO VARCHAR2(400),
    CONTENIDO VARCHAR2(4000),
    FECHA DATE
);


CREATE TABLE JNG_LOG_AUTENTICACION (
    ID_LOG_AUTH NUMBER PRIMARY KEY,
    ID_USUARIO NUMBER,
    FECHA_INTENTO TIMESTAMP,
    RESULTADO VARCHAR2(50),
    IP_ADDRESS VARCHAR2(50)
);

CREATE TABLE JNG_LOG_USER_ADMIN (
    ID_LOG_ADMIN NUMBER PRIMARY KEY,
    ID_USUARIO NUMBER,
    ACCION VARCHAR2(200),
    TABLA_AFECTADA VARCHAR2(100),
    FECHA_ACCION TIMESTAMP,
    DETALLES VARCHAR2(2000)
);
-------------------------------------------------------------------------------------------NO EJECUTAR SOLO ES PARA MOSTRAR LAS PRIMARY KEY-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE JNG_USUARIO ADD CONSTRAINT PK_USUARIO PRIMARY KEY (ID_USUARIO);
ALTER TABLE JNG_ROL ADD CONSTRAINT PK_ROL PRIMARY KEY (ID_ROL);
ALTER TABLE JNG_PERMISO ADD CONSTRAINT PK_PERMISO PRIMARY KEY (ID_PERMISO);
ALTER TABLE JNG_UNIVERSIDAD ADD CONSTRAINT PK_UNIVERSIDAD PRIMARY KEY (ID_UNIVERSIDAD);
ALTER TABLE JNG_SEDE ADD CONSTRAINT PK_SEDE PRIMARY KEY (ID_SEDE);
ALTER TABLE JNG_CARRERA ADD CONSTRAINT PK_CARRERA PRIMARY KEY (ID_CARRERA);
ALTER TABLE JNG_PLAN_ESTUDIOS ADD CONSTRAINT PK_PLAN_ESTUDIOS PRIMARY KEY (ID_PLAN);
ALTER TABLE JNG_ASIGNATURA ADD CONSTRAINT PK_ASIGNATURA PRIMARY KEY (ID_ASIGNATURA);
ALTER TABLE JNG_ASIGNATURA_CARRERA ADD CONSTRAINT PK_ASIGNATURA_CARRERA PRIMARY KEY (ID_PLAN, ID_ASIGNATURA);
ALTER TABLE JNG_PREREQUISITO ADD CONSTRAINT PK_PREREQUISITO PRIMARY KEY (ID_ASIGNATURA, ID_ASIGNATURA_REQ);
ALTER TABLE JNG_SECCION ADD CONSTRAINT PK_SECCION PRIMARY KEY (ID_SECCION);
ALTER TABLE JNG_PERIODO_ACADEMICO ADD CONSTRAINT PK_PERIODO PRIMARY KEY (ID_PERIODO);
ALTER TABLE JNG_AULA ADD CONSTRAINT PK_AULA PRIMARY KEY (ID_AULA);
ALTER TABLE JNG_HORARIO ADD CONSTRAINT PK_HORARIO PRIMARY KEY (ID_HORARIO);
ALTER TABLE JNG_ASIGNACION_DOCENTE ADD CONSTRAINT PK_ASIGNACION_DOCENTE PRIMARY KEY (ID_ASIGNACION_DOCENTE);
ALTER TABLE JNG_ASIGNACION_SECRETARIA ADD CONSTRAINT PK_ASIGNACION_SECRETARIA PRIMARY KEY (ID_ASIGNACION_SECRETARIA);
ALTER TABLE JNG_AYUDANTIA ADD CONSTRAINT PK_AYUDANTIA PRIMARY KEY (ID_AYUDANTIA);
ALTER TABLE JNG_ALUMNO ADD CONSTRAINT PK_ALUMNO PRIMARY KEY (ID_ALUMNO);
ALTER TABLE JNG_INSCRIPCION ADD CONSTRAINT PK_INSCRIPCION PRIMARY KEY (ID_INSCRIPCION);
ALTER TABLE JNG_TIPO_ACTIVIDAD ADD CONSTRAINT PK_TIPO_ACTIVIDAD PRIMARY KEY (ID_TIPO_ACTIVIDAD);
ALTER TABLE JNG_ACTIVIDAD ADD CONSTRAINT PK_ACTIVIDAD PRIMARY KEY (ID_ACTIVIDAD);
ALTER TABLE JNG_TIPO_EVALUACION ADD CONSTRAINT PK_TIPO_EVALUACION PRIMARY KEY (ID_TIPO_EVALUACION);
ALTER TABLE JNG_EVALUACION ADD CONSTRAINT PK_EVALUACION PRIMARY KEY (ID_EVALUACION);
ALTER TABLE JNG_NOTA ADD CONSTRAINT PK_NOTA PRIMARY KEY (ID_NOTA);
ALTER TABLE JNG_CONTENIDO ADD CONSTRAINT PK_CONTENIDO PRIMARY KEY (ID_CONTENIDO);
ALTER TABLE JNG_MATERIAL_CURSO ADD CONSTRAINT PK_MATERIAL_CURSO PRIMARY KEY (ID_MATERIAL);
ALTER TABLE JNG_MENSAJE_INTERNO ADD CONSTRAINT PK_MENSAJE_INTERNO PRIMARY KEY (ID_MENSAJE);
ALTER TABLE JNG_ANUNCIO ADD CONSTRAINT PK_ANUNCIO PRIMARY KEY (ID_ANUNCIO);
ALTER TABLE JNG_LOG_AUTENTICACION ADD CONSTRAINT PK_LOG_AUTENTICACION PRIMARY KEY (ID_LOG_AUTH);
ALTER TABLE JNG_LOG_USER_ADMIN ADD CONSTRAINT PK_LOG_USER_ADMIN PRIMARY KEY (ID_LOG_ADMIN);

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ROL
ALTER TABLE JNG_USUARIO ADD CONSTRAINT FK_USUARIO_ROL FOREIGN KEY (ID_ROL)
    REFERENCES JNG_ROL(ID_ROL);


-- ASIGNACION_DOCENTE
ALTER TABLE JNG_ASIGNACION_DOCENTE ADD CONSTRAINT FK_ASIGNDOC_USUARIO FOREIGN KEY (ID_USUARIO)
    REFERENCES JNG_USUARIO(ID_USUARIO);
ALTER TABLE JNG_ASIGNACION_DOCENTE ADD CONSTRAINT FK_ASIGNDOC_SECCION FOREIGN KEY (ID_SECCION)
    REFERENCES JNG_SECCION(ID_SECCION);

-- ASIGNACION_SECRETARIA
ALTER TABLE JNG_ASIGNACION_SECRETARIA ADD CONSTRAINT FK_ASIGNSEC_USUARIO FOREIGN KEY (ID_USUARIO)
    REFERENCES JNG_USUARIO(ID_USUARIO);
ALTER TABLE JNG_ASIGNACION_SECRETARIA ADD CONSTRAINT FK_ASIGNSEC_SEDE FOREIGN KEY (ID_SEDE)
    REFERENCES JNG_SEDE(ID_SEDE);

-- AYUDANTIA
ALTER TABLE JNG_AYUDANTIA ADD CONSTRAINT FK_AYUDANTIA_USUARIO FOREIGN KEY (ID_USUARIO)
    REFERENCES JNG_USUARIO(ID_USUARIO);
ALTER TABLE JNG_AYUDANTIA ADD CONSTRAINT FK_AYUDANTIA_CARRERA FOREIGN KEY (ID_CARRERA)
    REFERENCES JNG_CARRERA(ID_CARRERA);
ALTER TABLE JNG_AYUDANTIA ADD CONSTRAINT FK_AYUDANTIA_SECCION FOREIGN KEY (ID_SECCION)
    REFERENCES JNG_SECCION(ID_SECCION);

-- ALUMNO
ALTER TABLE JNG_ALUMNO ADD CONSTRAINT FK_ALUMNO_USUARIO FOREIGN KEY (ID_USUARIO)
    REFERENCES JNG_USUARIO(ID_USUARIO);

-- INSCRIPCION
-- Se eliminaron ANIO y SEMESTRE, pero las FK existentes están bien.
ALTER TABLE JNG_INSCRIPCION ADD CONSTRAINT FK_INSCRIPCION_ALUMNO FOREIGN KEY (ID_ALUMNO)
    REFERENCES JNG_ALUMNO(ID_ALUMNO);
ALTER TABLE JNG_INSCRIPCION ADD CONSTRAINT FK_INSCRIPCION_SECCION FOREIGN KEY (ID_SECCION)
    REFERENCES JNG_SECCION(ID_SECCION);

-- NOTA (CORREGIDO: Se cambia la referencia de ID_USUARIO a ID_ALUMNO)
ALTER TABLE JNG_NOTA ADD CONSTRAINT FK_NOTA_ALUMNO FOREIGN KEY (ID_ALUMNO)
    REFERENCES JNG_ALUMNO(ID_ALUMNO); -- Sustituye la FK incorrecta
ALTER TABLE JNG_NOTA ADD CONSTRAINT FK_NOTA_EVALUACION FOREIGN KEY (ID_EVALUACION)
    REFERENCES JNG_EVALUACION(ID_EVALUACION);

-- MATERIAL_CURSO
ALTER TABLE JNG_MATERIAL_CURSO ADD CONSTRAINT FK_MATERIAL_USUARIO FOREIGN KEY (ID_USUARIO)
    REFERENCES JNG_USUARIO(ID_USUARIO);
ALTER TABLE JNG_MATERIAL_CURSO ADD CONSTRAINT FK_MATERIAL_SECCION FOREIGN KEY (ID_SECCION)
    REFERENCES JNG_SECCION(ID_SECCION);

-- MENSAJE_INTERNO
ALTER TABLE JNG_MENSAJE_INTERNO ADD CONSTRAINT FK_MSG_ENVIA FOREIGN KEY (ID_USUARIO_ENVIA)
    REFERENCES JNG_USUARIO(ID_USUARIO);
ALTER TABLE JNG_MENSAJE_INTERNO ADD CONSTRAINT FK_MSG_RECIBE FOREIGN KEY (ID_USUARIO_RECIBE)
    REFERENCES JNG_USUARIO(ID_USUARIO);

-- ANUNCIO
ALTER TABLE JNG_ANUNCIO ADD CONSTRAINT FK_ANUNCIO_USUARIO FOREIGN KEY (ID_USUARIO)
    REFERENCES JNG_USUARIO(ID_USUARIO);
ALTER TABLE JNG_ANUNCIO ADD CONSTRAINT FK_ANUNCIO_SECCION FOREIGN KEY (ID_SECCION)
    REFERENCES JNG_SECCION(ID_SECCION);
ALTER TABLE JNG_ANUNCIO ADD CONSTRAINT FK_ANUNCIO_CARRERA FOREIGN KEY (ID_CARRERA)
    REFERENCES JNG_CARRERA(ID_CARRERA);

-- CARRERA
ALTER TABLE JNG_CARRERA ADD CONSTRAINT FK_CARRERA_DIRECTOR FOREIGN KEY (ID_DIRECTOR)
    REFERENCES JNG_USUARIO(ID_USUARIO);
ALTER TABLE JNG_CARRERA ADD CONSTRAINT FK_CARRERA_SEDE FOREIGN KEY (ID_SEDE)
    REFERENCES JNG_SEDE(ID_SEDE);

-- SEDE
ALTER TABLE JNG_SEDE ADD CONSTRAINT FK_SEDE_UNIVERSIDAD FOREIGN KEY (ID_UNIVERSIDAD)
    REFERENCES JNG_UNIVERSIDAD(ID_UNIVERSIDAD);

-- AULA
ALTER TABLE JNG_AULA ADD CONSTRAINT FK_AULA_SEDE FOREIGN KEY (ID_SEDE)
    REFERENCES JNG_SEDE(ID_SEDE);

-- PLAN_ESTUDIOS
ALTER TABLE JNG_PLAN_ESTUDIOS ADD CONSTRAINT FK_PLAN_CARRERA FOREIGN KEY (ID_CARRERA)
    REFERENCES JNG_CARRERA(ID_CARRERA);

-- ASIGNATURA_CARRERA
ALTER TABLE JNG_ASIGNATURA_CARRERA ADD CONSTRAINT FK_ASIGCARR_PLAN FOREIGN KEY (ID_PLAN)
    REFERENCES JNG_PLAN_ESTUDIOS(ID_PLAN);
ALTER TABLE JNG_ASIGNATURA_CARRERA ADD CONSTRAINT FK_ASIGCARR_ASIGNATURA FOREIGN KEY (ID_ASIGNATURA)
    REFERENCES JNG_ASIGNATURA(ID_ASIGNATURA);

-- PREREQUISITO
ALTER TABLE JNG_PREREQUISITO ADD CONSTRAINT FK_PREREQ_ASIG FOREIGN KEY (ID_ASIGNATURA)
    REFERENCES JNG_ASIGNATURA(ID_ASIGNATURA);
ALTER TABLE JNG_PREREQUISITO ADD CONSTRAINT FK_PREREQ_REQ FOREIGN KEY (ID_ASIGNATURA_REQ)
    REFERENCES JNG_ASIGNATURA(ID_ASIGNATURA);

-- SECCION
ALTER TABLE JNG_SECCION ADD CONSTRAINT FK_SECCION_ASIGNATURA FOREIGN KEY (ID_ASIGNATURA)
    REFERENCES JNG_ASIGNATURA(ID_ASIGNATURA);
ALTER TABLE JNG_SECCION ADD CONSTRAINT FK_SECCION_PERIODO FOREIGN KEY (ID_PERIODO)
    REFERENCES JNG_PERIODO_ACADEMICO(ID_PERIODO);

-- HORARIO
ALTER TABLE JNG_HORARIO ADD CONSTRAINT FK_HORARIO_SECCION FOREIGN KEY (ID_SECCION)
    REFERENCES JNG_SECCION(ID_SECCION);
ALTER TABLE JNG_HORARIO ADD CONSTRAINT FK_HORARIO_AULA FOREIGN KEY (ID_AULA)
    REFERENCES JNG_AULA(ID_AULA);

-- ACTIVIDAD
ALTER TABLE JNG_ACTIVIDAD ADD CONSTRAINT FK_ACTIVIDAD_SECCION FOREIGN KEY (ID_SECCION)
    REFERENCES JNG_SECCION(ID_SECCION);
ALTER TABLE JNG_ACTIVIDAD ADD CONSTRAINT FK_ACTIVIDAD_TIPO FOREIGN KEY (ID_TIPO_ACTIVIDAD)
    REFERENCES JNG_TIPO_ACTIVIDAD(ID_TIPO_ACTIVIDAD);

-- EVALUACION
ALTER TABLE JNG_EVALUACION ADD CONSTRAINT FK_EVAL_SECCION FOREIGN KEY (ID_SECCION)
    REFERENCES JNG_SECCION(ID_SECCION);
ALTER TABLE JNG_EVALUACION ADD CONSTRAINT FK_EVAL_TIPO FOREIGN KEY (ID_TIPO_EVALUACION)
    REFERENCES JNG_TIPO_EVALUACION(ID_TIPO_EVALUACION);

-- LOGS
ALTER TABLE JNG_LOG_AUTENTICACION ADD CONSTRAINT FK_LOG_AUTH_USUARIO FOREIGN KEY (ID_USUARIO)
    REFERENCES JNG_USUARIO(ID_USUARIO);
ALTER TABLE JNG_LOG_USER_ADMIN ADD CONSTRAINT FK_LOG_ADMIN_USUARIO FOREIGN KEY (ID_USUARIO)
    REFERENCES JNG_USUARIO(ID_USUARIO);
-----------------------------------------------SECUENCIA-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CREATE SEQUENCE JNG_SEQ_INSCRIPCION START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_ALUMNO START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_PERMISO START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_UNIVERSIDAD START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_SEDE START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_PLAN_ESTUDIOS START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_PERIODO_ACADEMICO START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_TIPO_ACTIVIDAD START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_TIPO_EVALUACION START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_CONTENIDO START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_ACTIVIDAD START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_ASIGNACION_DOCENTE START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_ASIGNACION_SECRETARIA START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_AYUDANTIA START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_ROL START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_USUARIO START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_ASIGNATURA START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_HORARIO START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_CARRERA START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_AULA START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_SECCION START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_MATERIAL_CURSO START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_ANUNCIO START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_MENSAJE_INTERNO START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_EVALUACION START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_NOTA START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_LOG_AUTENTICACION START WITH 1 INCREMENT BY 1 NOCACHE;
CREATE SEQUENCE JNG_SEQ_LOG_USER_ADMIN START WITH 1 INCREMENT BY 1 NOCACHE;


------------------------------------------------------------------------------------------------------crud----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD 1 =usuario CRUD

CREATE OR REPLACE PROCEDURE JNG_SP_USUARIO_INSERT(
    P_ID_ROL     JNG_USUARIO.ID_ROL%TYPE,
    P_NOMBRE     JNG_USUARIO.NOMBRE%TYPE,
    P_APELLIDO   JNG_USUARIO.APELLIDO%TYPE,
    P_RUT        JNG_USUARIO.RUT%TYPE,
    P_EMAIL      JNG_USUARIO.EMAIL%TYPE,
    P_PASSWORD   JNG_USUARIO.PASSWORD%TYPE,
    P_FECHA_NAC  JNG_USUARIO.FECHA_NAC%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_USUARIO.NEXTVAL;

    INSERT INTO JNG_USUARIO (
        ID_USUARIO, ID_ROL, NOMBRE, APELLIDO, RUT, EMAIL, PASSWORD, FECHA_NAC
    ) VALUES (
        V_ID, P_ID_ROL, P_NOMBRE, P_APELLIDO, P_RUT, P_EMAIL, P_PASSWORD, P_FECHA_NAC
    );

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_USUARIO_UPDATE(
    P_ID_USUARIO  JNG_USUARIO.ID_USUARIO%TYPE,
    P_ID_ROL      JNG_USUARIO.ID_ROL%TYPE,
    P_NOMBRE      JNG_USUARIO.NOMBRE%TYPE,
    P_APELLIDO    JNG_USUARIO.APELLIDO%TYPE,
    P_RUT         JNG_USUARIO.RUT%TYPE,
    P_EMAIL       JNG_USUARIO.EMAIL%TYPE,
    P_PASSWORD    JNG_USUARIO.PASSWORD%TYPE,
    P_FECHA_NAC   JNG_USUARIO.FECHA_NAC%TYPE,
    P_ESTADO      JNG_USUARIO.ESTADO%TYPE
)
AS
BEGIN
    UPDATE JNG_USUARIO
    SET ID_ROL = P_ID_ROL,
        NOMBRE = P_NOMBRE,
        APELLIDO = P_APELLIDO,
        RUT = P_RUT,
        EMAIL = P_EMAIL,
        PASSWORD = P_PASSWORD,
        FECHA_NAC = P_FECHA_NAC,
        ESTADO = P_ESTADO
    WHERE ID_USUARIO = P_ID_USUARIO;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_USUARIO_DELETE(
    P_ID_USUARIO  JNG_USUARIO.ID_USUARIO%TYPE
)
AS
BEGIN
    UPDATE JNG_USUARIO
    SET ESTADO = 'INACTIVE'
    WHERE ID_USUARIO = P_ID_USUARIO;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_USUARIO_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT *
        FROM JNG_USUARIO
        ORDER BY ID_USUARIO;
END;
/

CREATE OR REPLACE FUNCTION JNG_FN_GET_USUARIO_ID(
    P_RUT JNG_USUARIO.RUT%TYPE
)
RETURN NUMBER
AS
    V_ID NUMBER;
BEGIN
    SELECT ID_USUARIO INTO V_ID
    FROM JNG_USUARIO
    WHERE RUT = P_RUT;

    RETURN V_ID;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RETURN NULL;
END;
/
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD 2 = ROL

CREATE OR REPLACE PROCEDURE SP_INSERTAR_ROL(
    p_nombre_rol  VARCHAR2,
    p_descripcion  VARCHAR2
)
AS
BEGIN
    INSERT INTO JNG_ROL(ID_ROL, NOMBRE_ROL, DESCRIPCION)
    VALUES(JNG_SEQ_ROL.NEXTVAL, p_nombre_rol, p_descripcion);

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE SP_ACTUALIZAR_ROL(
    p_id_rol  NUMBER,
    p_nombre_rol  VARCHAR2,
    p_descripcion  VARCHAR2
)
AS
BEGIN
    UPDATE JNG_ROL
    SET NOMBRE_ROL = p_nombre_rol,
        DESCRIPCION = p_descripcion
    WHERE ID_ROL = p_id_rol;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE SP_ELIMINAR_ROL(
    p_id_rol  NUMBER
)
AS
BEGIN
    DELETE FROM JNG_ROL
    WHERE ID_ROL = p_id_rol;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE SP_LISTAR_ROLES(
    p_cursor OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN p_cursor FOR
        SELECT ID_ROL, NOMBRE_ROL, DESCRIPCION
        FROM JNG_ROL
        ORDER BY ID_ROL;
END;
/

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD3 = CARRERA

CREATE OR REPLACE PROCEDURE JNG_SP_CARRERA_INSERT(
    P_NOMBRE       JNG_CARRERA.NOMBRE%TYPE,
    P_DESCRIPCION  JNG_CARRERA.DESCRIPCION%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_CARRERA.NEXTVAL;

    INSERT INTO JNG_CARRERA (
        ID_CARRERA, NOMBRE, DESCRIPCION
    ) VALUES (
        V_ID, P_NOMBRE, P_DESCRIPCION
    );

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_CARRERA_UPDATE(
    P_ID_CARRERA   JNG_CARRERA.ID_CARRERA%TYPE,
    P_NOMBRE       JNG_CARRERA.NOMBRE%TYPE,
    P_DESCRIPCION  JNG_CARRERA.DESCRIPCION%TYPE
)
AS
BEGIN
    UPDATE JNG_CARRERA
    SET NOMBRE      = P_NOMBRE,
        DESCRIPCION = P_DESCRIPCION
    WHERE ID_CARRERA = P_ID_CARRERA;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_CARRERA_DELETE(
    P_ID_CARRERA JNG_CARRERA.ID_CARRERA%TYPE
)
AS
BEGIN
    DELETE FROM JNG_CARRERA
    WHERE ID_CARRERA = P_ID_CARRERA;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_CARRERA_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT *
        FROM JNG_CARRERA
        ORDER BY ID_CARRERA;
END;
/
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD4 =  ASIGNATURA
CREATE OR REPLACE PROCEDURE JNG_SP_ASIGNATURA_INSERT(
    P_NOMBRE       JNG_ASIGNATURA.NOMBRE%TYPE,
    P_DESCRIPCION  JNG_ASIGNATURA.DESCRIPCION%TYPE,
    P_CREDITOS     JNG_ASIGNATURA.CREDITOS%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_ASIGNATURA.NEXTVAL;

    INSERT INTO JNG_ASIGNATURA(
        ID_ASIGNATURA, NOMBRE, DESCRIPCION, CREDITOS
    ) VALUES(
        V_ID, P_NOMBRE, P_DESCRIPCION, P_CREDITOS
    );

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_ASIGNATURA_UPDATE(
    P_ID_ASIGNATURA JNG_ASIGNATURA.ID_ASIGNATURA%TYPE,
    P_NOMBRE        JNG_ASIGNATURA.NOMBRE%TYPE,
    P_DESCRIPCION   JNG_ASIGNATURA.DESCRIPCION%TYPE,
    P_CREDITOS      JNG_ASIGNATURA.CREDITOS%TYPE
)
AS
BEGIN
    UPDATE JNG_ASIGNATURA
    SET NOMBRE       = P_NOMBRE,
        DESCRIPCION  = P_DESCRIPCION,
        CREDITOS     = P_CREDITOS
    WHERE ID_ASIGNATURA = P_ID_ASIGNATURA;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_ASIGNATURA_DELETE(
    P_ID_ASIGNATURA JNG_ASIGNATURA.ID_ASIGNATURA%TYPE
)
AS
BEGIN
    DELETE FROM JNG_ASIGNATURA
    WHERE ID_ASIGNATURA = P_ID_ASIGNATURA;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_ASIGNATURA_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT *
        FROM JNG_ASIGNATURA
        ORDER BY ID_ASIGNATURA;
END;
/


--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD5 =  SEDE

CREATE OR REPLACE PROCEDURE JNG_SP_SEDE_INSERT(
    P_ID_UNIVERSIDAD  JNG_SEDE.ID_UNIVERSIDAD%TYPE,
    P_NOMBRE          JNG_SEDE.NOMBRE%TYPE,
    P_DIRECCION       JNG_SEDE.DIRECCION%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_SEDE.NEXTVAL;

    INSERT INTO JNG_SEDE (
        ID_SEDE, ID_UNIVERSIDAD, NOMBRE, DIRECCION
    ) VALUES (
        V_ID, P_ID_UNIVERSIDAD, P_NOMBRE, P_DIRECCION
    );

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_SEDE_UPDATE(
    P_ID_SEDE        JNG_SEDE.ID_SEDE%TYPE,
    P_ID_UNIVERSIDAD JNG_SEDE.ID_UNIVERSIDAD%TYPE,
    P_NOMBRE         JNG_SEDE.NOMBRE%TYPE,
    P_DIRECCION      JNG_SEDE.DIRECCION%TYPE
)
AS
BEGIN
    UPDATE JNG_SEDE
    SET ID_UNIVERSIDAD = P_ID_UNIVERSIDAD,
        NOMBRE         = P_NOMBRE,
        DIRECCION      = P_DIRECCION
    WHERE ID_SEDE = P_ID_SEDE;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_SEDE_DELETE(
    P_ID_SEDE JNG_SEDE.ID_SEDE%TYPE
)
AS
BEGIN
    DELETE FROM JNG_SEDE
    WHERE ID_SEDE = P_ID_SEDE;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_SEDE_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT *
        FROM JNG_SEDE
        ORDER BY ID_SEDE;
END;
/

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD6 = AULA

CREATE OR REPLACE PROCEDURE JNG_SP_AULA_INSERT(
    P_ID_SEDE     JNG_AULA.ID_SEDE%TYPE,
    P_NOMBRE      JNG_AULA.NOMBRE%TYPE,
    P_CAPACIDAD   JNG_AULA.CAPACIDAD%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_AULA.NEXTVAL;

    INSERT INTO JNG_AULA(
        ID_AULA, ID_SEDE, NOMBRE, CAPACIDAD
    ) VALUES (
        V_ID, P_ID_SEDE, P_NOMBRE, P_CAPACIDAD
    );

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_AULA_UPDATE(
    P_ID_AULA    JNG_AULA.ID_AULA%TYPE,
    P_ID_SEDE    JNG_AULA.ID_SEDE%TYPE,
    P_NOMBRE     JNG_AULA.NOMBRE%TYPE,
    P_CAPACIDAD  JNG_AULA.CAPACIDAD%TYPE
)
AS
BEGIN
    UPDATE JNG_AULA
    SET ID_SEDE   = P_ID_SEDE,
        NOMBRE    = P_NOMBRE,
        CAPACIDAD = P_CAPACIDAD
    WHERE ID_AULA = P_ID_AULA;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_AULA_DELETE(
    P_ID_AULA JNG_AULA.ID_AULA%TYPE
)
AS
BEGIN
    DELETE FROM JNG_AULA
    WHERE ID_AULA = P_ID_AULA;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_AULA_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT *
        FROM JNG_AULA
        ORDER BY ID_AULA;
END;
/

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD7 = INSCRIPCION

CREATE OR REPLACE PROCEDURE JNG_SP_INSCRIPCION_INSERT(
    P_ID_ALUMNO   JNG_INSCRIPCION.ID_ALUMNO%TYPE,
    P_ID_SECCION  JNG_INSCRIPCION.ID_SECCION%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_INSCRIPCION.NEXTVAL;

    INSERT INTO JNG_INSCRIPCION(
        ID_INSCRIPCION, ID_ALUMNO, ID_SECCION
    ) VALUES (
        V_ID, P_ID_ALUMNO, P_ID_SECCION
    );

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_INSCRIPCION_UPDATE(
    P_ID_INSCRIPCION   JNG_INSCRIPCION.ID_INSCRIPCION%TYPE,
    P_ID_ALUMNO        JNG_INSCRIPCION.ID_ALUMNO%TYPE,
    P_ID_SECCION       JNG_INSCRIPCION.ID_SECCION%TYPE
)
AS
BEGIN
    UPDATE JNG_INSCRIPCION
    SET ID_ALUMNO   = P_ID_ALUMNO,
        ID_SECCION  = P_ID_SECCION
    WHERE ID_INSCRIPCION = P_ID_INSCRIPCION;

    COMMIT;
END;
/


CREATE OR REPLACE PROCEDURE JNG_SP_INSCRIPCION_DELETE(
    P_ID_INSCRIPCION  JNG_INSCRIPCION.ID_INSCRIPCION%TYPE
)
AS
BEGIN
    DELETE FROM JNG_INSCRIPCION
    WHERE ID_INSCRIPCION = P_ID_INSCRIPCION;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_INSCRIPCION_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT *
        FROM JNG_INSCRIPCION
        ORDER BY ID_INSCRIPCION;
END;
/
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD8 = PERIODO ACADEMICO

CREATE OR REPLACE PROCEDURE JNG_SP_PERIODO_INSERT(
    P_YEAR       JNG_PERIODO_ACADEMICO.YEAR_NUM%TYPE,
    P_SEMESTRE   JNG_PERIODO_ACADEMICO.SEMESTRE%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_PERIODO_ACADEMICO.NEXTVAL;

    INSERT INTO JNG_PERIODO_ACADEMICO(
        ID_PERIODO, YEAR_NUM, SEMESTRE
    ) VALUES (
        V_ID, P_YEAR, P_SEMESTRE
    );

    COMMIT;
END;
/
CREATE OR REPLACE PROCEDURE JNG_SP_PERIODO_UPDATE(
    P_ID_PERIODO   JNG_PERIODO_ACADEMICO.ID_PERIODO%TYPE,
    P_YEAR         JNG_PERIODO_ACADEMICO.YEAR_NUM%TYPE,
    P_SEMESTRE     JNG_PERIODO_ACADEMICO.SEMESTRE%TYPE
)
AS
BEGIN
    UPDATE JNG_PERIODO_ACADEMICO
    SET YEAR_NUM  = P_YEAR,
        SEMESTRE  = P_SEMESTRE
    WHERE ID_PERIODO = P_ID_PERIODO;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_PERIODO_DELETE(
    P_ID_PERIODO JNG_PERIODO_ACADEMICO.ID_PERIODO%TYPE
)
AS
BEGIN
    DELETE FROM JNG_PERIODO_ACADEMICO
    WHERE ID_PERIODO = P_ID_PERIODO;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_PERIODO_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT *
        FROM JNG_PERIODO_ACADEMICO
        ORDER BY ID_PERIODO;
END;
/

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD9 = PLAN DE ESTUDIOS

CREATE OR REPLACE PROCEDURE JNG_SP_PLAN_INSERT(
    P_ID_CARRERA    JNG_PLAN_ESTUDIOS.ID_CARRERA%TYPE,
    P_YEAR_INICIO   JNG_PLAN_ESTUDIOS.YEAR_INICIO%TYPE,
    P_YEAR_FIN      JNG_PLAN_ESTUDIOS.YEAR_FIN%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_PLAN_ESTUDIOS.NEXTVAL;

    INSERT INTO JNG_PLAN_ESTUDIOS(
        ID_PLAN, ID_CARRERA, YEAR_INICIO, YEAR_FIN
    ) VALUES (
        V_ID, P_ID_CARRERA, P_YEAR_INICIO, P_YEAR_FIN
    );

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_PLAN_UPDATE(
    P_ID_PLAN       JNG_PLAN_ESTUDIOS.ID_PLAN%TYPE,
    P_ID_CARRERA    JNG_PLAN_ESTUDIOS.ID_CARRERA%TYPE,
    P_YEAR_INICIO   JNG_PLAN_ESTUDIOS.YEAR_INICIO%TYPE,
    P_YEAR_FIN      JNG_PLAN_ESTUDIOS.YEAR_FIN%TYPE
)
AS
BEGIN
    UPDATE JNG_PLAN_ESTUDIOS
    SET ID_CARRERA  = P_ID_CARRERA,
        YEAR_INICIO = P_YEAR_INICIO,
        YEAR_FIN    = P_YEAR_FIN
    WHERE ID_PLAN = P_ID_PLAN;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_PLAN_DELETE(
    P_ID_PLAN   JNG_PLAN_ESTUDIOS.ID_PLAN%TYPE
)
AS
BEGIN
    DELETE FROM JNG_PLAN_ESTUDIOS
    WHERE ID_PLAN = P_ID_PLAN;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_PLAN_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT *
        FROM JNG_PLAN_ESTUDIOS
        ORDER BY ID_PLAN;
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD10 = SECCION
CREATE OR REPLACE PROCEDURE JNG_SP_SECCION_INSERT(
    P_ID_ASIGNATURA JNG_SECCION.ID_ASIGNATURA%TYPE,
    P_ID_PERIODO    JNG_SECCION.ID_PERIODO%TYPE,
    P_NUMERO        JNG_SECCION.NUMERO%TYPE,
    P_GRUPO         JNG_SECCION.GRUPO%TYPE,
    P_CUPOS         JNG_SECCION.CUPOS%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_SECCION.NEXTVAL;

    INSERT INTO JNG_SECCION(
        ID_SECCION, ID_ASIGNATURA, ID_PERIODO, NUMERO, GRUPO, CUPOS
    ) VALUES (
        V_ID, P_ID_ASIGNATURA, P_ID_PERIODO, P_NUMERO, P_GRUPO, P_CUPOS
    );

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_SECCION_UPDATE(
    P_ID_SECCION   JNG_SECCION.ID_SECCION%TYPE,
    P_ID_ASIGNATURA JNG_SECCION.ID_ASIGNATURA%TYPE,
    P_ID_PERIODO    JNG_SECCION.ID_PERIODO%TYPE,
    P_NUMERO        JNG_SECCION.NUMERO%TYPE,
    P_GRUPO         JNG_SECCION.GRUPO%TYPE,
    P_CUPOS         JNG_SECCION.CUPOS%TYPE
)
AS
BEGIN
    UPDATE JNG_SECCION
    SET ID_ASIGNATURA = P_ID_ASIGNATURA,
        ID_PERIODO    = P_ID_PERIODO,
        NUMERO        = P_NUMERO,
        GRUPO         = P_GRUPO,
        CUPOS         = P_CUPOS
    WHERE ID_SECCION = P_ID_SECCION;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_SECCION_DELETE(
    P_ID_SECCION JNG_SECCION.ID_SECCION%TYPE
)
AS
BEGIN
    DELETE FROM JNG_SECCION
    WHERE ID_SECCION = P_ID_SECCION;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_SECCION_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT *
        FROM JNG_SECCION
        ORDER BY ID_SECCION;
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD 11= NOTA
CREATE OR REPLACE PROCEDURE JNG_SP_NOTA_INSERT(
    P_ID_ALUMNO     JNG_ALUMNO.ID_ALUMNO%TYPE,
    P_ID_EVALUACION JNG_EVALUACION.ID_EVALUACION%TYPE,
    P_NOTA          JNG_NOTA.NOTA%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_NOTA.NEXTVAL;

    INSERT INTO JNG_NOTA(ID_NOTA, ID_ALUMNO, ID_EVALUACION, NOTA)
    VALUES(V_ID, P_ID_ALUMNO, P_ID_EVALUACION, P_NOTA);

    COMMIT;
END;
/



CREATE OR REPLACE PROCEDURE JNG_SP_NOTA_UPDATE(
    P_ID_NOTA       JNG_NOTA.ID_NOTA%TYPE,
    P_ID_ALUMNO     JNG_ALUMNO.ID_ALUMNO%TYPE,
    P_ID_EVALUACION JNG_EVALUACION.ID_EVALUACION%TYPE,
    P_NOTA          JNG_NOTA.NOTA%TYPE
)
AS
BEGIN
    UPDATE JNG_NOTA
    SET ID_ALUMNO     = P_ID_ALUMNO,
        ID_EVALUACION = P_ID_EVALUACION,
        NOTA          = P_NOTA
    WHERE ID_NOTA = P_ID_NOTA;

    COMMIT;
END;
/


CREATE OR REPLACE PROCEDURE JNG_SP_NOTA_DELETE(
    P_ID_NOTA JNG_NOTA.ID_NOTA%TYPE
)
AS
BEGIN
    DELETE FROM JNG_NOTA
    WHERE ID_NOTA = P_ID_NOTA;

    COMMIT;
END;
/


CREATE OR REPLACE PROCEDURE JNG_SP_NOTA_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT *
        FROM JNG_NOTA
        ORDER BY ID_NOTA;
END;
/
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--CRUD12 = ALUMNO
CREATE OR REPLACE PROCEDURE JNG_SP_ALUMNO_INSERT(
    P_ID_USUARIO    JNG_ALUMNO.ID_USUARIO%TYPE,
    P_ID_CARRERA    JNG_ALUMNO.ID_CARRERA%TYPE,
    P_FECHA_INGRESO JNG_ALUMNO.FECHA_INGRESO%TYPE
)
AS
    V_ID NUMBER;
BEGIN
    V_ID := JNG_SEQ_ALUMNO.NEXTVAL;

    INSERT INTO JNG_ALUMNO (
        ID_ALUMNO, ID_USUARIO, ID_CARRERA, FECHA_INGRESO
    ) VALUES (
        V_ID, P_ID_USUARIO, P_ID_CARRERA, P_FECHA_INGRESO
    );

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_ALUMNO_UPDATE(
    P_ID_ALUMNO     JNG_ALUMNO.ID_ALUMNO%TYPE,
    P_ID_CARRERA    JNG_ALUMNO.ID_CARRERA%TYPE,
    P_FECHA_INGRESO JNG_ALUMNO.FECHA_INGRESO%TYPE
)
AS
BEGIN
    UPDATE JNG_ALUMNO
    SET ID_CARRERA = P_ID_CARRERA,
        FECHA_INGRESO = P_FECHA_INGRESO
    WHERE ID_ALUMNO = P_ID_ALUMNO;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_ALUMNO_DELETE(
    P_ID_ALUMNO JNG_ALUMNO.ID_ALUMNO%TYPE
)
AS
BEGIN
    DELETE FROM JNG_ALUMNO
    WHERE ID_ALUMNO = P_ID_ALUMNO;

    COMMIT;
END;
/

CREATE OR REPLACE PROCEDURE JNG_SP_ALUMNO_SELECT(
    P_CURSOR OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN P_CURSOR FOR
        SELECT 
            A.ID_ALUMNO,
            U.ID_USUARIO,
            U.RUT,
            U.NOMBRE || ' ' || U.APELLIDO AS NOMBRE_COMPLETO,
            C.NOMBRE AS NOMBRE_CARRERA,
            A.FECHA_INGRESO
        FROM JNG_ALUMNO A
        JOIN JNG_USUARIO U ON A.ID_USUARIO = U.ID_USUARIO
        JOIN JNG_CARRERA C ON A.ID_CARRERA = C.ID_CARRERA
        ORDER BY A.ID_ALUMNO;
END;
/

-------------------------------------------------------------------------------------gestores-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--Gestor: Inscripción de alumno en una sección
CREATE OR REPLACE PROCEDURE JNG_SP_INSCRIBIR_ALUMNO(
    P_ID_ALUMNO   JNG_ALUMNO.ID_ALUMNO%TYPE,
    P_ID_SECCION  JNG_SECCION.ID_SECCION%TYPE
)
IS
    V_COUNT NUMBER;
    V_CUPOS  JNG_SECCION.CUPOS%TYPE;
BEGIN
    -- Verificar si el alumno ya está inscrito
    SELECT COUNT(*) INTO V_COUNT
    FROM JNG_INSCRIPCION
    WHERE ID_ALUMNO = P_ID_ALUMNO
      AND ID_SECCION = P_ID_SECCION;

    IF V_COUNT > 0 THEN
        RAISE_APPLICATION_ERROR(-20001, 'Alumno ya inscrito en esta sección.');
    END IF;

    -- Verificar cupos
    SELECT CUPOS INTO V_CUPOS
    FROM JNG_SECCION
    WHERE ID_SECCION = P_ID_SECCION;

    IF V_CUPOS <= 0 THEN
        RAISE_APPLICATION_ERROR(-20002, 'No hay cupos disponibles.');
    END IF;

    -- Insertar inscripción (3NF Compliant)
    INSERT INTO JNG_INSCRIPCION(ID_INSCRIPCION, ID_ALUMNO, ID_SECCION)
    VALUES (JNG_SEQ_INSCRIPCION.NEXTVAL, P_ID_ALUMNO, P_ID_SECCION);

    -- Actualizar cupos
    UPDATE JNG_SECCION
    SET CUPOS = CUPOS - 1
    WHERE ID_SECCION = P_ID_SECCION;

    COMMIT;
END;
/

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--gestores: Asignar docente a una sección

CREATE OR REPLACE PROCEDURE JNG_SP_ASIGNAR_DOCENTE(
    P_ID_DOCENTE  JNG_USUARIO.ID_USUARIO%TYPE,
    P_ID_SECCION  JNG_SECCION.ID_SECCION%TYPE
)
IS
    V_COUNT NUMBER;
BEGIN
    -- Verificar si el docente ya está asignado
    SELECT COUNT(*) INTO V_COUNT
    FROM JNG_ASIGNACION_DOCENTE
    WHERE ID_USUARIO = P_ID_DOCENTE
      AND ID_SECCION = P_ID_SECCION;

    IF V_COUNT > 0 THEN
        RAISE_APPLICATION_ERROR(-20003, 'Docente ya asignado a esta sección.');
    END IF;

    -- Insertar asignación
    INSERT INTO JNG_ASIGNACION_DOCENTE(ID_ASIGNACION_DOCENTE, ID_USUARIO, ID_SECCION)
    VALUES (JNG_SEQ_ASIGNACION_DOCENTE.NEXTVAL, P_ID_DOCENTE, P_ID_SECCION);

    COMMIT;
END;
/

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE PROCEDURE JNG_SP_REGISTRAR_NOTA(
    P_ID_ALUMNO     JNG_ALUMNO.ID_ALUMNO%TYPE,
    P_ID_EVALUACION JNG_EVALUACION.ID_EVALUACION%TYPE,
    P_NOTA          NUMBER
)
IS
BEGIN
    -- Validar rango de nota
    IF P_NOTA < 0 OR P_NOTA > 7 THEN
        RAISE_APPLICATION_ERROR(-20004, 'Nota fuera del rango permitido (0-7).');
    END IF;

    -- Insertar o actualizar nota
    MERGE INTO JNG_NOTA N
    USING (SELECT P_ID_ALUMNO AS ID_ALUMNO, P_ID_EVALUACION AS ID_EVALUACION FROM DUAL) D
    ON (N.ID_ALUMNO = D.ID_ALUMNO AND N.ID_EVALUACION = D.ID_EVALUACION)
    WHEN MATCHED THEN
        UPDATE SET N.NOTA = P_NOTA
    WHEN NOT MATCHED THEN
        INSERT (ID_NOTA, ID_ALUMNO, ID_EVALUACION, NOTA)
        VALUES (JNG_SEQ_NOTA.NEXTVAL, P_ID_ALUMNO, P_ID_EVALUACION, P_NOTA);

    COMMIT;
END;
/
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--gestor: Subir material de curso
CREATE OR REPLACE PROCEDURE JNG_SP_SUBIR_MATERIAL(
    P_ID_USUARIO  JNG_USUARIO.ID_USUARIO%TYPE,
    P_ID_SECCION  JNG_SECCION.ID_SECCION%TYPE,
    P_TITULO      VARCHAR2,
    P_URL         VARCHAR2
)
IS
BEGIN
    -- Insertar material
    INSERT INTO JNG_MATERIAL_CURSO(
        ID_MATERIAL,
        ID_USUARIO,
        ID_SECCION,
        TITULO,
        URL,
        FECHA_SUBIDA
    )
    VALUES (
        JNG_SEQ_MATERIAL_CURSO.NEXTVAL,
        P_ID_USUARIO,
        P_ID_SECCION,
        P_TITULO,
        P_URL,
        SYSDATE
    );

    COMMIT;
END;
/

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--Gestor: Generar anuncio genérico
CREATE OR REPLACE PROCEDURE JNG_SP_GENERAR_ANUNCIO(
    P_ID_USUARIO  JNG_USUARIO.ID_USUARIO%TYPE,
    P_ID_SECCION  JNG_ANUNCIO.ID_SECCION%TYPE,
    P_ID_CARRERA  JNG_ANUNCIO.ID_CARRERA%TYPE,
    P_TITULO      VARCHAR2,
    P_CONTENIDO   VARCHAR2
)
IS
BEGIN
    -- Insertar anuncio
    INSERT INTO JNG_ANUNCIO(
        ID_ANUNCIO,
        ID_USUARIO,
        ID_SECCION,
        ID_CARRERA,
        TITULO,
        CONTENIDO,
        FECHA
    )
    VALUES (
        JNG_SEQ_ANUNCIO.NEXTVAL,
        P_ID_USUARIO,
        P_ID_SECCION,
        P_ID_CARRERA,
        P_TITULO,
        P_CONTENIDO,
        SYSDATE
    );

    COMMIT;
END;
/

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--Gestor: Generar anuncio para una sección específica

CREATE OR REPLACE PROCEDURE JNG_SP_GENERAR_ANUNCIO_SECCION(
    P_ID_USUARIO    JNG_USUARIO.ID_USUARIO%TYPE,
    P_ID_SECCION    JNG_SECCION.ID_SECCION%TYPE, 
    P_TITULO        JNG_ANUNCIO.TITULO%TYPE,     
    P_MENSAJE       JNG_ANUNCIO.CONTENIDO%TYPE   
)
IS
BEGIN
    INSERT INTO JNG_ANUNCIO(
        ID_ANUNCIO,
        ID_USUARIO,
        ID_SECCION,     
        ID_CARRERA,     
        TITULO,
        CONTENIDO,      
        FECHA
    )
    VALUES (
        JNG_SEQ_ANUNCIO.NEXTVAL,
        P_ID_USUARIO,
        P_ID_SECCION,   
        NULL,           
        P_TITULO,
        P_MENSAJE,      
        SYSDATE
    );

    COMMIT;
END;
/
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--Gestor: Generar anuncio para toda una carrera
CREATE OR REPLACE PROCEDURE JNG_SP_GENERAR_ANUNCIO_CARRERA(
    P_ID_USUARIO    JNG_USUARIO.ID_USUARIO%TYPE,
    P_ID_CARRERA    JNG_CARRERA.ID_CARRERA%TYPE, 
    P_TITULO        JNG_ANUNCIO.TITULO%TYPE,
    P_MENSAJE       JNG_ANUNCIO.CONTENIDO%TYPE   
)
IS
BEGIN
    INSERT INTO JNG_ANUNCIO(
        ID_ANUNCIO,
        ID_USUARIO,
        ID_SECCION,    
        ID_CARRERA,     
        TITULO,
        CONTENIDO,      
        FECHA
    )
    VALUES (
        JNG_SEQ_ANUNCIO.NEXTVAL,
        P_ID_USUARIO,
        NULL,          
        P_ID_CARRERA,   
        P_TITULO,
        P_MENSAJE,      
        SYSDATE
    );

    COMMIT;
END;
/
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-------------------------------------------reportes-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--reporte de alumnos con bajo rendimiento
CREATE OR REPLACE PROCEDURE JNG_SP_REPORTE_ALUMNOS_BAJO_RENDIMIENTO
IS
    
    CURSOR C_ALUMNOS IS
        SELECT 
            A.ID_ALUMNO, 
            U.NOMBRE,       
            U.APELLIDO,     
            AVG(N.NOTA) AS PROMEDIO
        FROM JNG_ALUMNO A
        JOIN JNG_USUARIO U ON A.ID_USUARIO = U.ID_USUARIO
        JOIN JNG_NOTA N ON A.ID_ALUMNO = N.ID_ALUMNO
        GROUP BY 
            A.ID_ALUMNO, 
            U.NOMBRE,      
            U.APELLIDO      
        HAVING AVG(N.NOTA) < 4;
        
    V_ALUMNO C_ALUMNOS%ROWTYPE;
BEGIN
    OPEN C_ALUMNOS;
    LOOP
        FETCH C_ALUMNOS INTO V_ALUMNO;
        EXIT WHEN C_ALUMNOS%NOTFOUND;
        
        -- Muestra el resultado
        DBMS_OUTPUT.PUT_LINE('Alumno: ' || V_ALUMNO.NOMBRE || ' ' || V_ALUMNO.APELLIDO || 
                             ' | Promedio: ' || V_ALUMNO.PROMEDIO);
    END LOOP;
    CLOSE C_ALUMNOS;
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--reporte de secciones llenas
CREATE OR REPLACE PROCEDURE JNG_SP_REPORTE_SECCIONES_LLENAS
IS
    CURSOR C_SECCIONES IS
        SELECT ID_SECCION, CUPOS
        FROM JNG_SECCION
        WHERE CUPOS = 0;

    V_SECCION C_SECCIONES%ROWTYPE;
BEGIN
    OPEN C_SECCIONES;
    LOOP
        FETCH C_SECCIONES INTO V_SECCION;
        EXIT WHEN C_SECCIONES%NOTFOUND;

        DBMS_OUTPUT.PUT_LINE('Sección ID: ' || V_SECCION.ID_SECCION || ' | Cupos: ' || V_SECCION.CUPOS);
    END LOOP;
    CLOSE C_SECCIONES;
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--reporte de materiales subidos por docente
CREATE OR REPLACE PROCEDURE JNG_SP_REPORTE_MATERIAL_DOCENTE
IS
    CURSOR C_MATERIALES IS
        SELECT 
            U.NOMBRE || ' ' || U.APELLIDO AS DOCENTE,
            M.TITULO, 
            M.URL AS ENLACE, 
            M.FECHA_SUBIDA
        FROM JNG_MATERIAL_CURSO M
        JOIN JNG_USUARIO U ON M.ID_USUARIO = U.ID_USUARIO 
        ORDER BY U.NOMBRE;

    V_MATERIAL C_MATERIALES%ROWTYPE;
BEGIN
    OPEN C_MATERIALES;
    LOOP
        FETCH C_MATERIALES INTO V_MATERIAL;
        EXIT WHEN C_MATERIALES%NOTFOUND;

        DBMS_OUTPUT.PUT_LINE('Docente: ' || V_MATERIAL.DOCENTE || 
                             ' | Titulo: ' || V_MATERIAL.TITULO || 
                             ' | URL: ' || V_MATERIAL.ENLACE || 
                             ' | Fecha: ' || V_MATERIAL.FECHA_SUBIDA);
    END LOOP;
    CLOSE C_MATERIALES;
END;
/
-------------------------------------------------------------------TRIGGER-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--Trigger para auditoría y validaciones
CREATE OR REPLACE TRIGGER JNG_TRG_INSERT_ALUMNO
AFTER INSERT ON JNG_ALUMNO
FOR EACH ROW
DECLARE
    V_NOMBRE_USUARIO JNG_USUARIO.NOMBRE%TYPE;
    V_APELLIDO_USUARIO JNG_USUARIO.APELLIDO%TYPE;
BEGIN
    SELECT NOMBRE, APELLIDO INTO V_NOMBRE_USUARIO, V_APELLIDO_USUARIO
    FROM JNG_USUARIO
    WHERE ID_USUARIO = :NEW.ID_USUARIO;

    DBMS_OUTPUT.PUT_LINE('Se ha agregado un alumno: ' || V_NOMBRE_USUARIO || ' ' || V_APELLIDO_USUARIO || 
                         ' | ID_ALUMNO: ' || :NEW.ID_ALUMNO || ' | ID_USUARIO: ' || :NEW.ID_USUARIO);
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--Trigger para auditoría de actualización de notas
CREATE OR REPLACE TRIGGER JNG_TRG_UPDATE_NOTA
AFTER UPDATE OF NOTA ON JNG_NOTA
FOR EACH ROW
BEGIN
    DBMS_OUTPUT.PUT_LINE('Nota modificada para alumno ID ' || :NEW.ID_ALUMNO || 
                         ', Evaluación ID ' || :NEW.ID_EVALUACION || 
                         ' | Nota anterior: ' || :OLD.NOTA || 
                         ', Nueva nota: ' || :NEW.NOTA);
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--Trigger para control de cupos en inscripciones
CREATE OR REPLACE TRIGGER JNG_TRG_CONTROL_CUPOS
BEFORE INSERT ON JNG_INSCRIPCION
FOR EACH ROW
DECLARE
    V_CUPOS NUMBER;
BEGIN
    SELECT CUPOS INTO V_CUPOS FROM JNG_SECCION WHERE ID_SECCION = :NEW.ID_SECCION;

    IF V_CUPOS <= 0 THEN
        RAISE_APPLICATION_ERROR(-20010, 'No hay cupos disponibles en la sección ' || :NEW.ID_SECCION);
    END IF;
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--Trigger para notificar subida de material por docente
CREATE OR REPLACE TRIGGER JNG_TRG_MATERIAL_DOCENTE
AFTER INSERT ON JNG_MATERIAL_CURSO
FOR EACH ROW
BEGIN
    DBMS_OUTPUT.PUT_LINE('Material agregado por docente ID ' || :NEW.ID_USUARIO || 
                         ' | Título: ' || :NEW.TITULO || 
                         ' | Fecha: ' || :NEW.FECHA_SUBIDA);
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--Trigger para auditoría de asignación de docente a sección
CREATE OR REPLACE TRIGGER JNG_TRG_ASIGNACION_DOCENTE
AFTER INSERT ON JNG_ASIGNACION_DOCENTE
FOR EACH ROW
BEGIN
    DBMS_OUTPUT.PUT_LINE('Docente ID ' || :NEW.ID_USUARIO || ' asignado a sección ' || :NEW.ID_SECCION);
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
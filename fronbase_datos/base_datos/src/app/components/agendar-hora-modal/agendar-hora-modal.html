<div class="modal-overlay" *ngIf="isOpen" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Agendar Cita con {{ docente?.nombre || 'Docente' }}</h2>
      <button class="close-btn" (click)="closeModal()">
        <span>&times;</span>
      </button>
    </div>

    <div class="modal-body">
      <!-- Error message -->
      <div *ngIf="errorMessage" class="alert alert-danger">
        {{ errorMessage }}
      </div>

      <!-- Success message -->
      <div *ngIf="successMessage" class="alert alert-success">
        {{ successMessage }}
      </div>

      <!-- Docente info -->
      <div class="docente-info" *ngIf="docente">
        <p><strong>Email:</strong> {{ docente.email }}</p>
        <p *ngIf="docente.horarioAtencion"><strong>Horario de Atención:</strong> {{ docente.horarioAtencion }}</p>
      </div>

      <!-- Form -->
      <div class="form-group">
        <label for="dia">Día</label>
        <select
          id="dia"
          [(ngModel)]="selectedDia"
          class="form-control"
          [disabled]="isLoading"
        >
          <option *ngFor="let horario of horariosDisponibles" [value]="horario.dia">
            {{ horario.dia }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="hora">Hora</label>
        <select
          id="hora"
          [(ngModel)]="selectedHora"
          class="form-control"
          [disabled]="isLoading"
        >
          <option value="">Selecciona una hora</option>
          <option *ngFor="let hora of getHorasDisponibles()" [value]="hora">
            {{ hora }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="motivo">Motivo de la Cita</label>
        <textarea
          id="motivo"
          [(ngModel)]="motivo"
          placeholder="Describe el motivo de tu cita"
          class="form-control"
          rows="4"
          [disabled]="isLoading"
        ></textarea>
      </div>
    </div>

    <div class="modal-footer">
      <button
        class="btn btn-secondary"
        (click)="closeModal()"
        [disabled]="isLoading"
      >
        Cancelar
      </button>
      <button
        class="btn btn-primary"
        (click)="agendarHora()"
        [disabled]="isLoading || !selectedDia || !selectedHora || !motivo.trim()"
      >
        {{ isLoading ? 'Agendando...' : 'Agendar Cita' }}
      </button>
    </div>
  </div>
</div>
